@import url("observablehq:default.css");
@import url("observablehq:theme-sun-faded.css");
/*@import url("./marks.css");*/ /* wait for fix */

:root {
  --theme-foreground-pop: oklch(from #f09a6f l c h / calc(alpha - 0))
}

html {
	scroll-behavior: smooth;
  overflow-y: scroll !important;
}

.home {
  max-width: 642px;
}

main h1:has(+ h2) {

  font-size: 1.1em;
  font-family: var(--sans-serif);
  color: var(--theme-foreground);

  letter-spacing: 1px;

  &+h2 {
    font-family: var(--serif);
    font-size: 1.1em;
    color: var(--theme-foreground-faint);

    a[href] {
      color:unset;
    }

    &:after {
      display: block;
      position: relative;
      top: 0.35em;
      text-align: center;
    }
  }
}

main h3 {

  padding-block-start: 0.5rem;
  font-family: var(--sans-serif);
  font-size: 1.035em;
  color: var(--theme-foreground)

}

main :is(p):last-child {
  margin-block-end: unset;
}

header {
  position: relative;
}

header>h1 {
  font-size: 1.75rem;
  letter-spacing: 0.31rem;
  font-family: var(--sans-serif);

  &+h2 {
    font-family: var(--serif);
    color: var(--theme-foreground-faint);
    font-size: 1.159rem;
  }
}

body {
  /*font: 18px / 1.5 var(--serif);*/

  font-family: "Source Serif 4", serif !important;
  font-optical-sizing: auto;
  font-weight: 300;
}

body:not(:has([href="#post"])) footer nav {
  display: none !important;
}

.card {

  border: unset;
  border-radius: 3px;

  padding: unset;
  padding-block-start: 1.5em;
  padding-block-end: 1.25em;
  padding-inline-start: 1.5em;
  border-bottom: 1px solid var(--theme-foreground-faintest) !important;

  & h2 {
    letter-spacing: 0.5px;
    margin-bottom: 0;
    font-weight: bold;
  }

  & h2+h3 {
    font-family: var(--serif);
    font-size: 15px;
    font-style: italic;
  }

}

.bookmark {

  overflow: hidden;
  position: relative;

  /*&:before {
    content: "";
    position: absolute;
    left: -25px;
    width: 20px;
    height: 100%;

    transform: rotate(-45deg);
    background-color: rgb(180, 155, 155);
  }*/

  &:after {
    content: "";
    position: absolute;
    right: -25px;
    top: -30px;
    width: 30px;
    height: 100%;


    transform: rotate(-45deg);
    background-color: rgb(180, 155, 155);
  }
}

#observablehq-footer nav {
  a {
    border-radius: 0;
    padding: 0.75 rem;
    /*span {
      font-size:0.825rem;
    }*/
  }

  a:nth-child(2) {
    span {
      text-align: end;
    }
  }
}

#observablehq-main:has([href="#post"]) {

  /*view-transition-name: hero;*/

  background: var(--theme-background-alt);
  border-bottom: 1px solid var(--theme-foreground-faintest) !important;

  padding: 2rem;
  /* margin: 1rem 0;*/
  max-width: calc(640px - 4rem);

  blockquote:first-of-type {
    font-family:var(--serif);
    font-weight:400;
    font-size:20px;
  }

}

/*@media (pointer:none),
(pointer:coarse) {
  main:has([href="#post"]) {
    padding: 1.5rem;
    max-width: calc(640px - 3rem) !important;
  }
}*/


#observablehq-header {
  margin: 0.6rem auto;
}

#observablehq-main {
  margin: unset;
  min-height: unset;
  /*calc(100vh - 26rem);*/
  left: max(0rem, calc(50% - 640px + 4rem));
  hyphens: auto;
}

code,
.bio {
  hyphens: none;

  * {
    font-family: var(--monospace) !important;
    font-style: unset !important;
  }
}

.article {
  max-width: calc(640px - 2rem);
}

#observablehq-footer {
  margin-top: 1rem;
}

#observablehq-sidebar {
  visibility: hidden !important;
}

#observablehq-center {
  padding-left: unset !important;
}

#observablehq-sidebar-toggle {
  display: none !important;
}

::view-transition-old(*),
::view-transition-new(*) {
  mix-blend-mode: normal;
}

::view-transition-old(root),
::view-transition-new(root) {
  animation: none;
}

/* Old stuff going out */

::view-transition-old(hero) {
  animation: fadeOut 350ms ease forwards;
}

/* New stuff coming in */
::view-transition-new(hero) {
  animation: fadeIn 350ms ease forwards;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateX(-50vw);
  }

  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes fadeOut {
  from {
    opacity: 1;
    transform: translateX(0);
  }

  to {
    opacity: 0;
    transform: translateX(50vw);
  }
}

.gh {
  position: absolute;
  top: 0.4rem;
  right: 0;
}

[alt="hide"] {
  display: none;
}

/* mobile overrides */
@media (pointer:none),
(pointer:coarse) {
  body {
    font: 16px / 1.5 var(--serif);
  }

  code {
    font-size: 12px;
  }

  #observablehq-main:has([href="#post"]) {
    margin: -2rem -2rem 0 -2rem;
    max-width: unset;

    blockquote:first-of-type {
      margin-inline:unset;
      font-size:19px;
    }
  }

  #observablehq-center:has(main > h2 > a[href="#post"]) header hr {
    margin-inline: -2rem;
  }

  #observablehq-footer nav a span {
    font-size: 0.84rem;
  }

}


/* Progress indicator */

@keyframes grow-progress {
  from {
    transform: scaleX(0);
  }

  to {
    transform: scaleX(1);
  }
}

html {
  scroll-timeline: --page-scroll block;
}

#progress {
  position: relative;

  z-index: 10;
  top: calc(1rem - 2px);
  display:block;
  margin-bottom: -2px; /* 1.5px for mobile preview */
  margin-inline-start: -2rem;
  margin-inline-end: -2px;
  transform-origin: 0rem 50%;
  height:2px;
  background-color: var(--theme-foreground-pop);
  /*border-bottom: solid 2px #f09a6f; /*#ff6a1f;*/
  opacity: 0.95;

}

main h1:first-child {
  z-index: 10;
  position: relative;
  background-color: var(--theme-background-alt);

  /*&:before {
    z-index:9;
    content: "";
    position:absolute;
    display: block;
    height: 10rem;
    width:2rem;
    left:-2rem;
    top: -2rem;
   
    background: linear-gradient(180deg, rgba(51,49,48,1) 0%, rgba(51,49,48,0) 100%);
    //outline:1px solid red;

  }*/

  +h2 {
    position: sticky !important;

    z-index: 9;
    top: 0;
    background: var(--theme-background-alt);

    margin-top: -1rem;
    border-block-start: solid 1rem var(--theme-background-alt);

    margin-bottom: 0.1rem;
    border-block-end: solid calc(0.42rem) var(--theme-background-alt);

    margin-inline: calc(-0.5rem);
    border-inline: solid 0.5rem var(--theme-background-alt);

    box-shadow: var(--theme-background-alt) 0px 0px 24px;

    &:after {
      content: "";
      display: block;
      height: 0.5rem;
      margin-inline-end: -0.1rem;
      margin-inline-start: -0.05rem;
      border-bottom: solid 1px var(--theme-foreground-faint);

      opacity: 1;
    }
  
  }

}

:is(h1:not(:nth-child(1)), h2:not(:nth-child(2)), h3, h4, h5, h6) {
  scroll-margin-top: 3.5em;
}

#progress {
  animation: grow-progress auto linear;
  animation-timeline: --page-scroll;
}

.upward {
  --offset: 100%; /* control when the button appear */
  --size: 2rem;
  position: sticky;
  display:block;

  bottom: calc(0.75 * var(--size));
  margin-top: calc(-0rem - 0.5 * var(--size));
  margin-bottom: calc(-1rem - 0.5 * var(--size));
  
  height:var(--size);
  width: var(--size);
  left:calc(100% - 0.5 * var(--size));
  background: var(--theme-foreground-pop);
  font-size: 0;
  opacity:0.85;
}
.upward:before {
  content: "";
  position: absolute;
  inset: 35%;
  transform: translateY(20%) rotate(-45deg);
  border-top: 4px solid #fff;
  border-right: 4px solid #fff;
  border-radius: 3px;

}

@supports (animation-timeline: view()) {
  @keyframes fade-in {
    from { opacity: 0 }
    to   { opacity: 1 }
  }

  @keyframes animate-in-and-out {
    contain 0%  {
      opacity: 0; transform: translateX(100%);
    }
    contain 5%  {
      opacity: 0.85; transform: translateX(0%);
    }
    
    contain 85%  {
      opacity: 0.85; transform: translateX(0%);
    }
    contain 90%  {
      opacity: 1; transform: translateX(100%);
    }
    contain 100%  {
      opacity: 1; transform: translateX(100%);
    }
  }
  
  @keyframes shadow-in {
    to { box-shadow: 0 10px 10px var(--theme-foreground-pop) }
  }
  
  .upward {
    animation: animate-in-and-out auto linear both;
    animation-timeline: scroll();
    
  }
  
  .other-el {
    animation-name: shadow-in;
  }
}